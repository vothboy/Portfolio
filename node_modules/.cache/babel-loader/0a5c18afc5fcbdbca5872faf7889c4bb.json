{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _token = require(\"./token\");\n\nvar FEDAUTHINFOID = {\n  STSURL: 0x01,\n  SPN: 0x02\n};\n\nfunction fedAuthInfoParser(parser, _colMetadata, _options, callback) {\n  parser.readUInt32LE(function (tokenLength) {\n    parser.readBuffer(tokenLength, function (data) {\n      var spn, stsurl;\n      var offset = 0;\n      var countOfInfoIDs = data.readUInt32LE(offset);\n      offset += 4;\n\n      for (var i = 0; i < countOfInfoIDs; i++) {\n        var fedauthInfoID = data.readUInt8(offset);\n        offset += 1;\n        var fedAuthInfoDataLen = data.readUInt32LE(offset);\n        offset += 4;\n        var fedAuthInfoDataOffset = data.readUInt32LE(offset);\n        offset += 4;\n\n        switch (fedauthInfoID) {\n          case FEDAUTHINFOID.SPN:\n            spn = data.toString('ucs2', fedAuthInfoDataOffset, fedAuthInfoDataOffset + fedAuthInfoDataLen);\n            break;\n\n          case FEDAUTHINFOID.STSURL:\n            stsurl = data.toString('ucs2', fedAuthInfoDataOffset, fedAuthInfoDataOffset + fedAuthInfoDataLen);\n            break;\n          // ignoring unknown fedauthinfo options\n\n          default:\n            break;\n        }\n      }\n\n      callback(new _token.FedAuthInfoToken(spn, stsurl));\n    });\n  });\n}\n\nvar _default = fedAuthInfoParser;\nexports.default = _default;\nmodule.exports = fedAuthInfoParser;","map":null,"metadata":{},"sourceType":"script"}
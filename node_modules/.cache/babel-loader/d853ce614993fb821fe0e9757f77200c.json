{"ast":null,"code":"// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License. See License.txt in the project root for license information.\nimport { __extends } from \"tslib\";\nimport { HttpHeaders } from \"../httpHeaders\";\nimport { Constants } from \"../util/constants\";\nimport { getDefaultUserAgentKey, getPlatformSpecificData } from \"./msRestUserAgentPolicy\";\nimport { BaseRequestPolicy } from \"./requestPolicy\";\n\nfunction getRuntimeInfo() {\n  var msRestRuntime = {\n    key: \"ms-rest-js\",\n    value: Constants.msRestVersion\n  };\n  return [msRestRuntime];\n}\n\nfunction getUserAgentString(telemetryInfo, keySeparator, valueSeparator) {\n  if (keySeparator === void 0) {\n    keySeparator = \" \";\n  }\n\n  if (valueSeparator === void 0) {\n    valueSeparator = \"/\";\n  }\n\n  return telemetryInfo.map(function (info) {\n    var value = info.value ? \"\" + valueSeparator + info.value : \"\";\n    return \"\" + info.key + value;\n  }).join(keySeparator);\n}\n\nexport var getDefaultUserAgentHeaderName = getDefaultUserAgentKey;\nexport function getDefaultUserAgentValue() {\n  var runtimeInfo = getRuntimeInfo();\n  var platformSpecificData = getPlatformSpecificData();\n  var userAgent = getUserAgentString(runtimeInfo.concat(platformSpecificData));\n  return userAgent;\n}\nexport function userAgentPolicy(userAgentData) {\n  var key = !userAgentData || userAgentData.key == undefined ? getDefaultUserAgentKey() : userAgentData.key;\n  var value = !userAgentData || userAgentData.value == undefined ? getDefaultUserAgentValue() : userAgentData.value;\n  return {\n    create: function create(nextPolicy, options) {\n      return new UserAgentPolicy(nextPolicy, options, key, value);\n    }\n  };\n}\n\nvar UserAgentPolicy =\n/** @class */\nfunction (_super) {\n  __extends(UserAgentPolicy, _super);\n\n  function UserAgentPolicy(_nextPolicy, _options, headerKey, headerValue) {\n    var _this = _super.call(this, _nextPolicy, _options) || this;\n\n    _this._nextPolicy = _nextPolicy;\n    _this._options = _options;\n    _this.headerKey = headerKey;\n    _this.headerValue = headerValue;\n    return _this;\n  }\n\n  UserAgentPolicy.prototype.sendRequest = function (request) {\n    this.addUserAgentHeader(request);\n    return this._nextPolicy.sendRequest(request);\n  };\n\n  UserAgentPolicy.prototype.addUserAgentHeader = function (request) {\n    if (!request.headers) {\n      request.headers = new HttpHeaders();\n    }\n\n    if (!request.headers.get(this.headerKey) && this.headerValue) {\n      request.headers.set(this.headerKey, this.headerValue);\n    }\n  };\n\n  return UserAgentPolicy;\n}(BaseRequestPolicy);\n\nexport { UserAgentPolicy };","map":null,"metadata":{},"sourceType":"module"}